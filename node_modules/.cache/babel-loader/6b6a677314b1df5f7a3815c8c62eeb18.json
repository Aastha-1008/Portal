{"ast":null,"code":"import BaseError from './baseError';\nexport class TimeoutError extends BaseError {\n  constructor(msg) {\n    super('TimeoutError', msg);\n  }\n}\nfunction makeTimeout(timeoutMs) {\n  let timerId = null;\n  const promise = new Promise((_, reject) => {\n    timerId = setTimeout(() => {\n      reject(new TimeoutError('Timeout'));\n    }, timeoutMs);\n  });\n  return {\n    timerId: timerId,\n    promise: promise\n  };\n}\nexport function fetchWithTimeout(url, options, timeoutMs) {\n  const {\n    promise: timeoutPromise,\n    timerId\n  } = makeTimeout(timeoutMs);\n  const abortController = new AbortController();\n  return Promise.race([fetch(url, {\n    ...options,\n    signal: abortController.signal\n  }), timeoutPromise]).catch(error => {\n    if (error instanceof TimeoutError) {\n      abortController.abort();\n    }\n    throw error;\n  }).then(response => {\n    clearTimeout(timerId);\n    return response;\n  });\n}","map":null,"metadata":{},"sourceType":"module"}